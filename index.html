<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Minha casa Nova</title>

    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <link rel="stylesheet" href="css/app.css">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700'" rel="stylesheet">

	<script src="js/jquery.1.12.4.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/knockout-3.4.2.js"></script>
</head>
<body>
<header>
    <div class="container-fluid">
        <h1>O melhor plano de vida para</h1>
        <h1>comprar seu primeiro imóvel</h1>
    </div>
</header>

<main>
    <!-- ko if: passo() === 1 -->
    <section id="section-landing-page">
        <div class="container">
            <h2>Em quanto tempo eu vou quitar meu imóvel?</h2>
            <div id="section-idade">
                <div class="row justify-content-center">
                    <div class="col-xs-12 col-sm-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <img class="img" src="img/casal-novinhos.png">
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <img class="img" src="img/casal.png">
                        </div>
                        <div class="col-xs-12 col-sm-12  col-md-12 col-lg-4">
                            <img class="img" src="img/casal-velhinhos.png">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <h2>Qual imóvel eu quero comprar?</h2>
            <div id="section-tipo-imovel">
                <div class="row justify-content-center">
                    <div class="col-xs-12 col-sm-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <img class="img" src="img/casinha.png">
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <img class="img" src="img/casa.png">
                        </div>
                        <div class="col-xs-12 col-sm-12  col-md-12 col-lg-4">
                            <img class="img" src="img/casao.png">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <h2>Quer saber como você pode se planejar para comprar seu imóvel?</h2>
            <div id="section-dados-pessoais">
                <div class="row justify-content-center">
                    <div class="col-xs-12 col-sm-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <h4>Valor da Parcela</h4>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="1" name="valorParcela" data-bind="checked: valorParcela, click: limparValorImovel" />Até R$1000,00 
                                </label>                    
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="2" name="valorParcela" data-bind="checked: valorParcela, click: limparValorImovel" />Até R$1500,00
                                </label>                
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="3" name="valorParcela" data-bind="checked: valorParcela, click: limparValorImovel" />Até R$2000,00
                                </label>                    
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                            <div id="ou">OU</div>
                        </div>
                        <div class="col-xs-12 col-sm-12  col-md-12 col-lg-4">
                            <h4>Valor do Imóvel</h4>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="1" name="valorImovel" data-bind="checked: valorImovel, click: limparValorParcela" />Até R$200 mil
                                </label>                    
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="2" name="valorImovel" data-bind="checked: valorImovel, click: limparValorParcela" />Até R$400 mil
                                </label>                
                            </div>
                            <div class="radio">
                                <label>
                                    <input type="radio" value="3" name="valorImovel" data-bind="checked: valorImovel, click: limparValorParcela" />Até R$500 mil
                                </label>                    
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center nome-email">
                    <div class="form-group">
                        <label for="nome">Nome completo</label>
                        <input type="text" id="nome" class="form-control" required pattern="^([a-zA-ZáéíóúàâêôãõüçÁÉÍÓÚÀÂÊÔÃÕÜÇ ]|\n){2,50} ([a-zA-ZáéíóúàâêôãõüçÁÉÍÓÚÀÂÊÔÃÕÜÇ ]|\n){2,50}$" placeholder="Nome Completo" data-bind="textInput: nome">
                        <span id="helpBlock" class="help-block" data-bind="visible: temErroNoNome">Informe um nome válido. Ex: Nome Sobrenome</span>                 
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" class="form-control" required pattern="^[A-Za-z0-9](([_.-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([.-]?[a-zA-Z0-9]+)*)([.][A-Za-z]{2,4})$" placeholder="exemplo@email.com" data-bind="textInput: email">
                        <span id="helpBlock" class="help-block" data-bind="visible: temErroNoEmail">Informe um e-mail válido. Ex: exemplo@email.com</span>
                    </div> 
                </div>
            </div>
        </div>
        <div class="container">
            <button class="btn btn-warning btn-lg" data-bind="click: iniciarCadastro, enable: deveIniciarORegistro">CONSTRUIR PLANEJAMENTO</button>
        </div> 
    </section>
    <!-- /ko -->
    <!-- ko if: passo() === 2 -->
    <!-- /ko -->
    <!-- ko if: passo() === 3 -->
    <!-- /ko -->
    <!-- ko if: passo() === 4 -->
    <!-- /ko -->
    <!-- ko if: passo() === 5 -->
    <!-- /ko -->
</main>

<footer>
    <div class="container">
        <h4>Meu Primeiro Imóvel</h4>
        <p>Todos os direitos reservados. Outrubro, 2017.</p>
    </div>
</footer>

</body>

<script type="text/javascript">
    var viewModel = function () {
        self = this;

        self.passo = ko.observable(1);
        self.valorParcela = ko.observable('');
        self.valorImovel = ko.observable('');        
        self.nome = ko.observable(''); 
        self.email = ko.observable(''); 
        self.temErroNoNome = ko.observable(false); 
        self.temErroNoEmail = ko.observable(false);
        
        self.deveIniciarORegistro = ko.computed(function(){
            return (self.valorParcela() !== '' || self.valorImovel() !== '') &&
                    self.nome() !== '' &&
                    self.email() !== '';
        }, this);
        self.valorR$Parcela = ko.computed(function(){
            var valor = 0;
            switch (self.valorParcela()){
                case '1':
                    valor = 1000;
                    break;
                case '2':
                    valor = 1500;
                    break;
                case '3':
                    valor = 2000;
                    break;
                default:
                    valor = 0;
                    break;
            }
            return valor;
        }, this);
        self.valorR$Imovel = ko.computed(function(){
            var valor = 0;
            switch (self.valorImovel()){
                case '1':
                    valor = 200000;
                    break;
                case '2':
                    valor = 400000;
                    break;
                case '3':
                    valor = 500000;
                    break;
                default:
                    valor = 0;
                    break;
            }
            return valor;
        }, this);
        
        self.limparValorImovel = function(){
            self.valorImovel('');
            return true;
        };

        self.limparValorParcela = function(){
            self.valorParcela('');
            return true;
        };

        self.iniciarCadastro = function(valor){
            ehNomeValido();
            ehEmailValido();
            if(!self.temErroNoNome() && !self.temErroNoEmail()) {
                //cadastrar();
                proximoPasso()
            }
        };
        
        function proximoPasso(){
            var passo = self.passo() + 1;
            self.passo(passo);
        };

        function passoAnterior(){
            var passo = self.passo() - 1;
            self.passo(passo);
        };

        function ehNomeValido(){
            self.temErroNoNome(false);
	        er = /^([a-zA-ZáéíóúàâêôãõüçÁÉÍÓÚÀÂÊÔÃÕÜÇ ]|\n){2,50} ([a-zA-ZáéíóúàâêôãõüçÁÉÍÓÚÀÂÊÔÃÕÜÇ ]|\n){2,50}$/; 
	        if(!er.exec(self.nome())){
                self.temErroNoNome(true);
            }
        }  

        function ehEmailValido(){
            self.temErroNoEmail(false);
	        er = /^[A-Za-z0-9](([_.-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([.-]?[a-zA-Z0-9]+)*)([.][A-Za-z]{2,4})$/; 
	        if(!er.exec(self.email())){
                self.temErroNoEmail(true);
            }
        }    

        function cadastrar(){
            var params = {valorParcela: self.valorR$Parcela(), valorImovel: self.valorR$Imovel(), nome: self.nome(), email: self.email()}
            var url = "http://www.meuprimeiroimovel.com.br/algumacoisa.php";
            $.post(url, params)
                .done(function() {
                    alert('success');
                })
                .fail(function() {
                    alert('error');
                });
        }               
    }

    ko.applyBindings(new viewModel());
</script>
</html>